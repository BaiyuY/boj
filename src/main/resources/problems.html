<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="google-signin-client_id" content="496017852143-19a6kjh7mvhlhb0pp4l5fsj5s5empgt8.apps.googleusercontent.com">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script>
        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
              window.location.href = '/';
            });
        }

        function onLoad() {
          gapi.load('auth2', function() {
            gapi.auth2.init();
          });
        }

        $(document).ready(function() {
            $('.delete-problem').each(function() {
                var id = $(this).attr('problem-id');
                $(this).click(function() {
                    $.ajax({
                        url: '/problem/' + id,
                        type: 'DELETE',
                        success: function(result) {
                            location.reload();
                        }
                    });
                });
            });
        });
    </script>
    <script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
    <title>Problems</title>
</head>
<body>
<ol>
#foreach( $problem in $problems )
    <li>
        <a href="/problem/$problem.id">$problem.title</a>
        #if ($is_admin)
            <a class="delete-problem" problem-id="$problem.id" href="#">X</a>
            <a href="/problem/edit/$problem.id">E</a>
        #end
    </li>
#end
</ol>
#if ($is_admin)
<a href="/problem/create">create</a><br>
#end
<a href="#" onclick="signOut();">Sign out</a>
</body>
</html>
